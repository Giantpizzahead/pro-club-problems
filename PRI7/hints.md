1. The number of colors is quite small...

2. Try fixing the color that all fence sections should end up with, and see if the solution to this subproblem can be extended to solve the full one. 

3. When a fence section that isn't the right color is encountered, it has to be repainted, no matter what. So, why not skip a bunch of sections along the way (other sections that are within the $l$ to $r$ interval)?